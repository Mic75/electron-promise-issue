<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Electron Promise Issues</title>
</head>
<body>
<div>
    <input id="input" placeholder="key,value" autofocus/>
    <button id="add">Add</button>
</div>
<div id="content"></div>
<script>
var promiseStore = require('electron').remote.require('./promise-store'),
    inputElem = document.getElementById('input'),
    addButton = document.getElementById('add');

function refreshStore(){
  promiseStore.getItems().then(store => {
    document.getElementById('content').innerHTML = JSON.stringify(store);
  });
}

function addItem(){
  const [ ,key, value] = inputElem.value.match(/(.*)[,\s-.](.*)/);
  promiseStore.addItem(key, value);
  refreshStore();
}

window.addEventListener('load', () => {
  refreshStore();
});

inputElem.addEventListener('keypress', (event) => {
  if (event.charCode === 13){
    addItem();
  }
});

addButton.addEventListener('click', () => {
  addItem();
});

</script>
</body>
</html>